# 多用户demo

## 1 基本功能

### 新增
- 获取所有兄弟用户（API测试）
- 获取主用户（API测试）
- 设置主用户（API测试）
- 切换兄弟用户（API测试）

### 修改
- 登录后默认登录主用户（API测试、第三方做web测试）
- 创建团队（API测试、手机号做web测试）
- 邀请加入团队（API测试、第三方登录做web测试、注册做web测试）
- 退出团队（API测试）
- 解散团队（API测试）
- 重新加入团队（API测试、第三方登录做web测试、注册做web测试）

## 2 存在问题：
1  默认登录帐号与修改账号密码的问题

## 3 测试说明：

### 3.1 【新增】获取所有兄弟用户
由于其他测试会使用该接口，因此不做单独测试，多人加入团队后，做API测试

### 3.2 【新增】获取主用户

#### API测试

（通过3.3设置主用户测试）
- 1 个人用户获取主用户
- 2 团队用户：
  - 2.1 新建团队的团队拥有者获取主用户
  - 2.2 加入团队的团队成员获取主用户

### 3.3 【新增】设置主用户

#### API测试

测试时也会测试`3.2【新增】获取主用户`和`【修改】登录后默认登录主用户`接口

- 1 个人用户设置主用户，无法设置其他主用户
- 2 团队用户：
  - 2.1 只有一个兄弟用户，无法设置其他主用户
  - 2.2 设置一个企业拥有者的兄弟用户作为主用户
  - 2.3 设置一个企业普通成员的兄弟用户作为主用户
  - 2.4 设置一个退出企业的个人用户作为主用户

### 【新增】切换兄弟用户
做API测试
- 1 不属于同一个superUser时，切换用户会失败
- 2 同一个superUser下
  - 2.1 创建了两个团队，则两个团队之间可以互相切换
  - 2.2 创建了一个团队，加入了一个团队，则两个团队之间可以互相切换
  - 2.3 加入了两个团队，则两个团队之间可以互相切换
  - 2.4 创建了两个团队，退出了其中一个团队，则退出的团队不可以进行切换
  - 2.5 创建了一个团队，加入了一个团队，退出创建的团队，则退出的团队不可进行切换
  - 2.6 创建了一个团队，加入了一个团队，退出加入的团队，则退出的团队不可以进行切换
  - 2.7 加入了两个团队，退出了其中一个团队，则退出的团队不可以进行切换

### 【修改】登录后默认登录主用户
登录后默认登录主用户，做API测试
针对第三方登录，做web测试

#### API测试
在`【新增】设置主用户`中测试

### 【修改】创建团队（API测试、手机号做web测试）
创建团队时暂停验证，做API测试
模拟真实环境下创建团队，做web测试

- 1 当前账号的所有兄弟账号均无公司
  - 1.1 当前账号的所有兄弟账号均未创建过公司
  - 1.2 当前登录用户曾经创建过公司，然后退出了
  - 1.3 当前登录用户的其他兄弟账号曾经创建过公司，然后退出了
- 2 当前账号的兄弟账号有至少一家公司

首次创建：当前的登录账号从未创建过任何公司。创建了然后退出了，再创建公司不属于首次创建。
首次创建公司时，登录用户不存在任何加入团队的历史记录。
首次创建后，账号下只有一个用户。

首次加入：当前的登录账号从未加入过任何公司。加入了然后退出了，再加入公司不属于首次加入。
首次加入公司时，登录用户不存在任何加入团队的历史记录。
首次加入后，账号下只有一个用户

- 1 首次创建
  - 1.1 首次创建：在当前登录的用户上直接创建公司，并将个人相关的文集和计划带到新的公司
- 2 非首次创建
  - 1.2 当前登录用户已经创建了一家公司且目前还在这家公司中，创建第二家公司。
    在同一账号下新建用户关联新建的公司，不携带文集和计划
  - 1.3 当前登录用户已经加入了一家公司且目前还在这家公司中，又作为创建者创建了一家公司。
    在同一账号下新建用户关联新建的公司，不携带文集和计划
  - 1.4 当前登录用户曾经首次创建过一家公司，然后退出了这家公司，又创建了一家公司。
    这种情况，由于未来该用户有可能重新加入首次创建的公司，所以首次创建公司的用户需要保留！
    所以，再创建第二家公司的时候，在同一账号下新建用户关联新建的公司，不携带文集和计划。
  - 1.5 当前登录用户曾经加入过一家公司，然后退出了这家公司，又创建了一家公司。
    这种情况，由于未来该用户有可能重新加入首次加入的公司，所以首次加入公司的用户需要保留！
    所以，再创建第二家公司的时候，在同一账号下新建用户关联新建的公司，不携带文集和计划。
  

### 【修改】邀请加入团队及重新加入团队（API测试、第三方登录做web测试、注册做web测试）

首次创建：当前的登录用户的账号（超用户）从未创建过任何公司。创建了然后退出了，再创建公司不属于首次创建。
首次创建公司时，登录用户不存在任何加入团队的历史记录。
首次创建后，账号下只有一个用户。

首次加入：当前的登录用户的账号（超用户）从未加入过任何公司。加入了然后退出了，再加入公司不属于首次加入。
首次加入公司时，登录用户不存在任何加入团队的历史记录。
首次加入后，账号下只有一个用户

- 1 首次加入
  - 1.1 首次加入：在当前登录的用户上直接加入公司，携带个人文集和计划？
- 2 非首次加入
  - 2.1 当前登录用户已经创建了一家公司且目前还在这家公司中，接受邀请加入第二家公司。
    在同一账号下新建用户关联第二家公司
  - 2.2 当前登录用户已经加入了一家公司且目前还在这家公司中，又接受邀请加入第二家公司。
    在同一账号下新建用户关联第二家公司，不携带文集和计划
  - 2.3 当前登录用户曾经首次创建过一家公司，然后退出了这家公司，又加入另一家公司。
    这种情况，由于未来该用户有可能重新加入首次加入的第一家公司，所以首次加入的公司用户需要保留！
    所以，在加入第二家公司的时候，在同一账号下新建用户关联第二家公司，不携带文集和计划。
  - 2.4 当前登录用户曾经加入过一家公司，然后退出了这家公司，又加入另一家公司。
    这种情况，由于未来该用户有可能重新加入首次加入的第一家公司，所以首次加入的公司用户需要保留！
    所以，在加入第二家公司的时候，在同一账号下新建用户关联第二家公司，不携带文集和计划。
  - 2.5 当前登录用户曾经首次创建过一家公司，然后退出了这家公司，又接受邀请加入同一家公司。
    重新使用原账号加入的这家公司，携带笔记和计划
  - 2.6 当前登录用户曾经首次加入过一家公司，然后退出了这家公司，又接受邀请加入同一家公司。
    重新使用原账号加入的这家公司，携带笔记和计划
  - 2.7 当前登录用户曾经首次创建过一家公司，又创建过一家公司，然后退出了第二家公司，又接受邀请加入第二家公司。
    重新使用第二家公司的原账号加入第二家公司，携带笔记和计划
  - 2.8 当前登录用户曾经首次创建过一家公司，又加入一家公司，然后退出了第二家公司，又接受邀请加入第二家公司。
    重新使用第二家公司的原账号加入第二家公司，携带笔记和计划

#### API测试
- 1 直接邀请
  - 1.1 从未注册过日事清：手机账号或邮箱直接作为登录账号加入团队
  - 1.2 已注册过日事清
    - 1.2.1 从未加入过该公司：发送邀请 -> 受邀请人登录账号接受邀请
    - 1.2.2 已经在该公司中：已经在该公司中了，不发送邀请
    - 1.2.3 目前不在该公司，曾经加入过该公司：发送邀请 -> 受邀请人登录帐号接受邀请重新加入公司
    
- 2 批量邀请
  - 2.1 从未注册过日事清：新建账号（此时的账号是随机密码！）并通过邮件或者短信方式将公司加入链接发送给用户。
  **这种方式有问题，新用户已经有账号了，但是不知道密码，此时只能走找回密码流程**
  - 2.2 已经注册过日事清
    - 2.2.1 从未加入过该公司：发送邀请 -> 受邀请人登录帐号接受邀请
    - 2.2.2 已经在该公司中：不发送邀请
    - 2.2.3 目前不在该公司，曾经加如果该公司：发送邀请 -> 受邀请人登录帐号接受邀请重新加入公司
    
- 3 链接邀请
  - 3.1 从未注册过日事清的用户：打开邀请链接 -> 输入手机号或者邮箱注册 -> 注册完成加入团队
  - 3.2 已经注册过日事清的用户
    - 3.2.1 从未加入过该公司：打开邀请链接 -> 输入手机号或者邮箱登陆 -> 登录后加入团队
    - 3.2.2 已经在该公司：打开邀请链接 -> 输入手机号或者邮箱登陆 -> 已经加入团队
    - 3.2.3 目前不在该公司，曾经加如果该公司：打开邀请链接 -> 输入手机号或者邮箱登陆 -> 登录后加入团队
    
#### web测试
- 1 链接邀请
  - 1.1 从未注册过日事清的用户打开邀请链接
    - 1.1.1 QQ登录： 注册完成加入团队
    - 1.1.2 微信登录： 注册完成加入团队
    - 1.1.3 新浪登录： 注册完成加入团队
  - 1.2 已经用第三方登录注册过日事清的用户（不做重复加入公司测试）
    - 1.2.1 QQ登录： 登录完成加入团队
    - 1.2.2 微信登录： 登录完成加入团队
    - 1.2.3 新浪登录： 登录完成加入团队

### 【修改】退出团队（API测试）

唯一团队

做API测试

- 退出时测试切换团队的功能
- 退出主用户所在团队
  - 退出唯一团队
- 退出非主用户所在团队
- 退出是唯一管理员的团队

### 【修改】解散团队（API测试）
做API测试

- 解散团队

### 【修改】日事清系统内修改账号和密码

- 修改主账号和密码

##  问题整理
1  修改用户名和密码问题
2  私人文集带到公司的问题？个人创建公司的时候带文集，加入公司的时候不带？
3  创建者退出团队，怎么处理？
4  创建团队、加入团队后，均会切换账号，退出团队会不会切换帐号？
5  如果一个人已经有一个公司，那么他受邀请加入其他公司的时候，会新生成一个帐号加入另一家公司，在前端页面没有做的情况下无法显示


----

## 4 web功能测试用例

- (*)标记的为手动测试

### 1.1 测试前准备工作

#### 清理账号

- 原web注册邮箱（）
- 原web注册手机号（）
- 原webQQ账号信息
- 原web微信账号信息
- 原web微博帐号信息
- 原web钉钉账号信息

### 1.2 测试用例（web driver部分）

#### web端注册

1. 邮箱注册
2. 手机号注册
3. QQ注册
4. 微信注册
5. 微博注册
6. 钉钉注册

#### PC端注册（*）

1. 邮箱注册（*）
2. 手机号注册（*）
3. QQ注册（*）
4. 微信注册（*）
5. 微博注册（*）

#### iOS注册

1. 手机号注册
2. QQ注册（*）
3. 微信注册（*）
4. 微博注册（*）

#### 安卓注册

1. 手机号注册
2. QQ注册（*）
3. 微信注册（*）
4. 微博注册（*）

#### web端登录

1. 邮箱登录
2. 手机号登录
3. QQ登录
4. 微信登录
5. 微博登录
6. 钉钉登录

#### PC端登录（*）

1. 邮箱登录（*）
2. 手机号登录（*）
3. QQ登录（*）
4. 微信登录（*）
5. 微博登录（*）

#### iOS登录

1. 手机号登录
2. QQ登录（*）
3. 微信登录（*）
4. 微博登录（*）

#### 安卓登录

1. 手机号登录
2. QQ登录（*）
3. 微信登录（*）
4. 微博登录（*）

#### 邀请注册
短信邮件邀请？
链接邀请：邮箱、手机号、QQ、微信、微博、钉钉
微信扫码邀请：邮箱、手机号、QQ、微博

#### 邀请登录
短信邮件邀请？
链接邀请：邮箱、手机号、QQ、微信、微博、钉钉
微信扫码邀请：邮箱、手机号、QQ、微博

##  api功能测试用例
